(window.webpackJsonp=window.webpackJsonp||[]).push([[39],{249:function(a,s,t){"use strict";t.r(s);var e=t(0),r=Object(e.a)({},(function(){var a=this.$createElement;this._self._c;return this._m(0)}),[function(){var a=this,s=a.$createElement,t=a._self._c||s;return t("div",{staticClass:"content"},[t("h2",{attrs:{id:"发布教程"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#发布教程"}},[a._v("#")]),a._v(" 发布教程")]),a._v(" "),t("p",{staticClass:"show-images"},[t("img",{attrs:{src:"/images/undraw_version_control_9bpv.svg",width:"40%"}})]),a._v(" "),t("h3",{attrs:{id:"概述"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#概述"}},[a._v("#")]),a._v(" 概述")]),a._v(" "),t("p",[a._v("平台发布集成三种发布形式，便于适用于不同的场景，分别为:")]),a._v(" "),t("ul",[t("li",[a._v("[不推荐]FastJar 发布: 此适应于一般服务器发布，便于管理，通过修改"),t("code",[a._v("yml")]),a._v("文件及后缀，调整"),t("code",[a._v("开发")]),a._v("、"),t("code",[a._v("测试")]),a._v("、"),t("code",[a._v("生产")]),a._v("等多种环境;")]),a._v(" "),t("li",[a._v("[推荐]容器发布：此适于 k8s 容器(docker-compose)集成，便于管理容器，通过调整不同的参数适应多种环境；")])]),a._v(" "),t("h3",{attrs:{id:"发布类型"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#发布类型"}},[a._v("#")]),a._v(" 发布类型")]),a._v(" "),t("p",[a._v("发布默认按集成 jenkins 说明")]),a._v(" "),t("h4",{attrs:{id:"fastjar-发布"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#fastjar-发布"}},[a._v("#")]),a._v(" FastJar 发布")]),a._v(" "),t("blockquote",[t("p",[a._v("此适合于开发过程")])]),a._v(" "),t("h5",{attrs:{id:"前置条件"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#前置条件"}},[a._v("#")]),a._v(" 前置条件")]),a._v(" "),t("ul",[t("li",[a._v("jenkins 环境")]),a._v(" "),t("li",[a._v("Linux 服务器")]),a._v(" "),t("li",[a._v("配置好 jdk 及环境")])]),a._v(" "),t("h5",{attrs:{id:"发布过程"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#发布过程"}},[a._v("#")]),a._v(" 发布过程")]),a._v(" "),t("p",[a._v("此发布类型为 springboot 自带的，直接 maven 命令打包即可：")]),a._v(" "),t("div",{staticClass:"language-shell extra-class"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[a._v("mvn -B -f "),t("span",{pre:!0,attrs:{class:"token variable"}},[a._v("${WORKSPACE}")]),a._v("/pom.xml clean package -U\n\n"),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("BUILD_ID")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("dontKillMe\n"),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("bash")]),a._v(" ./start.sh restart\n")])])]),t("p",[a._v("注:"),t("code",[a._v("其中start.sh脚本为平台提供的脚本")])]),a._v(" "),t("h4",{attrs:{id:"docker-镜像发布"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#docker-镜像发布"}},[a._v("#")]),a._v(" Docker 镜像发布")]),a._v(" "),t("p",[a._v("Docker 镜像是平台集成的默认打包镜像，平台可以直接打包成 docker 镜像，便于直接发布到测试环境")]),a._v(" "),t("h5",{attrs:{id:"镜像发布命令"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#镜像发布命令"}},[a._v("#")]),a._v(" 镜像发布命令")]),a._v(" "),t("p",[a._v("启动示例:")]),a._v(" "),t("div",{staticClass:"language-shell extra-class"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[a._v("sudo")]),a._v(" docker run -p "),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("8080")]),a._v(":8080 registry.cn-shenzhen.aliyuncs.com/alinesno-cloud/test-student-projcet:"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),a._v("镜像版本号"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("\n-e "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("JAVA_TOOL_OPTIONS")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[a._v('"-Xms128m -Xmx512m -Dspring.profiles.active=dev"')]),a._v("\n")])])]),t("h4",{attrs:{id:"k8s-发布"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#k8s-发布"}},[a._v("#")]),a._v(" K8S 发布")]),a._v(" "),t("h5",{attrs:{id:"前置条件-2"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#前置条件-2"}},[a._v("#")]),a._v(" 前置条件")]),a._v(" "),t("ul",[t("li",[a._v("jenkins 环境")]),a._v(" "),t("li",[a._v("k8s 环境")])]),a._v(" "),t("h5",{attrs:{id:"发布过程-2"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#发布过程-2"}},[a._v("#")]),a._v(" 发布过程")]),a._v(" "),t("p",[a._v("平台自动生成开发环境的 k8s.yml 脚本在工程目录下面，便于开发集成发布，同时 k8s 发布需要同步打成 docker 镜像，发布命令如下")]),a._v(" "),t("div",{staticClass:"language-shell extra-class"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[a._v("mvn -B -f "),t("span",{pre:!0,attrs:{class:"token variable"}},[a._v("${WORKSPACE}")]),a._v("/pom.xml clean compile jib:build\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 发布k8s")]),a._v("\nkubectl delete -f  "),t("span",{pre:!0,attrs:{class:"token variable"}},[a._v("${WORKSPACE}")]),a._v("/k8s-dev.yaml\nkubectl apply -f  "),t("span",{pre:!0,attrs:{class:"token variable"}},[a._v("${WORKSPACE}")]),a._v("/k8s-dev.yaml\n")])])]),t("p",[a._v("注:"),t("code",[a._v("先delete是完全清除，目前暂时没有更好的办法，理论上应该apply命令就可以")])]),a._v(" "),t("h3",{attrs:{id:"其它"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#其它"}},[a._v("#")]),a._v(" 其它")]),a._v(" "),t("ul",[t("li",[a._v("略")])])])}],!1,null,null,null);s.default=r.exports}}]);